{"ast":null,"code":"import _slicedToArray from \"/home/kevin/Desktop/kevin-bagnall-eog-react-assessment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/kevin/Desktop/kevin-bagnall-eog-react-assessment/src/Features/Graph/ShowData.tsx\";\nimport React, { useEffect } from 'react';\nimport { actions } from './reducer';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createClient, useQuery, Provider } from 'urql';\nimport Graph from './Graph';\nvar client = createClient({\n  url: 'https://react.eogresources.com/graphql'\n});\nvar LAST_KNOWN_MEASUREMENT_QUERY = \"\\n   query($metricName: String!){\\n       getLastKnownMeasurement(metricName: $metricName){\\n           metric\\n           at\\n           value\\n           unit\\n       }\\n   } \\n\";\nvar MEASUREMENTS_QUERY = \"\\n   query($[Measurement]: MeasurementQuery){\\n       getMeasurements([Measurement]: $[Measurement]){\\n           metric\\n           at\\n           value\\n           unit\\n       }\\n   }\\n\";\nvar GET_MULTIPLE_MEASUREMENTS_QUERY = \"\\n   query($input: [MeasurementQuery]){\\n       getMultipleMeasurements(input: $input){\\n           metric\\n           measurements\\n       }\\n   }\\n\";\n\nvar getMetric = function getMetric(state) {\n  var name = state.metric.name;\n  return {\n    name: name\n  };\n};\n\nvar getLastKnownMeasurement = function getLastKnownMeasurement(state) {\n  var lastMeasurement = state.metric.lastMeasurement;\n  return {\n    lastMeasurement: lastMeasurement\n  };\n};\n\nvar ShowData = function ShowData(metric) {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(getMetric),\n      name = _useSelector.name;\n\n  var _useSelector2 = useSelector(getLastKnownMeasurement),\n      lastMeasurement = _useSelector2.lastMeasurement;\n\n  var input = {\n    before: Date.now(),\n    after: lastMeasurement.at\n  };\n  var metricName = name;\n\n  var _useQuery = useQuery({\n    query: LAST_KNOWN_MEASUREMENT_QUERY,\n    variables: {\n      metricName: metricName\n    },\n    pause: !metricName,\n    pollInterval: 5000,\n    requestPolicy: 'cache-and-network'\n  }),\n      _useQuery2 = _slicedToArray(_useQuery, 1),\n      result = _useQuery2[0];\n\n  var _useQuery3 = useQuery({\n    query: MEASUREMENTS_QUERY,\n    variables: {\n      input: input\n    },\n    pause: !metricName,\n    pollInterval: 5000,\n    requestPolicy: 'cache-and-network'\n  }),\n      _useQuery4 = _slicedToArray(_useQuery3, 1),\n      historicalResult = _useQuery4[0];\n\n  var fetching = result.fetching,\n      data = result.data,\n      error = result.error;\n  useEffect(function () {\n    if (error) {\n      console.log(error);\n    }\n\n    if (!data) return;\n    var getLastKnownMeasurement = data.getLastKnownMeasurement;\n    console.log(typeof getLastKnownMeasurement, getLastKnownMeasurement);\n    dispatch(actions.lastMeasurement(getLastKnownMeasurement));\n  }, [dispatch, data, error]); // console.log(historicalResult)\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, React.createElement(Graph, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }));\n};\n\nexport default (function () {\n  return React.createElement(Provider, {\n    value: client,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, React.createElement(ShowData, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }));\n});","map":{"version":3,"sources":["/home/kevin/Desktop/kevin-bagnall-eog-react-assessment/src/Features/Graph/ShowData.tsx"],"names":["React","useEffect","actions","useDispatch","useSelector","createClient","useQuery","Provider","Graph","client","url","LAST_KNOWN_MEASUREMENT_QUERY","MEASUREMENTS_QUERY","GET_MULTIPLE_MEASUREMENTS_QUERY","getMetric","state","name","metric","getLastKnownMeasurement","lastMeasurement","ShowData","dispatch","input","before","Date","now","after","at","metricName","query","variables","pause","pollInterval","requestPolicy","result","historicalResult","fetching","data","error","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { IState } from '../../store'\nimport { actions } from './reducer'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { createClient, useQuery, Provider } from 'urql'\nimport { Chip, LinearProgress } from '@material-ui/core'\nimport Graph from './Graph'\n\nconst client = createClient({\n    url: 'https://react.eogresources.com/graphql'\n})\n\nconst LAST_KNOWN_MEASUREMENT_QUERY = `\n   query($metricName: String!){\n       getLastKnownMeasurement(metricName: $metricName){\n           metric\n           at\n           value\n           unit\n       }\n   } \n`\nconst MEASUREMENTS_QUERY = `\n   query($[Measurement]: MeasurementQuery){\n       getMeasurements([Measurement]: $[Measurement]){\n           metric\n           at\n           value\n           unit\n       }\n   }\n`\n\nconst GET_MULTIPLE_MEASUREMENTS_QUERY = `\n   query($input: [MeasurementQuery]){\n       getMultipleMeasurements(input: $input){\n           metric\n           measurements\n       }\n   }\n`\n\nconst getMetric = (state: IState) => {\n    const { name } = state.metric\n    return { name }\n}\n\nconst getLastKnownMeasurement = (state: IState) => {\n    const lastMeasurement = state.metric.lastMeasurement\n    return { lastMeasurement }\n}\n\nconst ShowData = (metric: any) => {\n\n    const dispatch = useDispatch()\n    const { name } = useSelector(getMetric)\n    const { lastMeasurement } = useSelector(getLastKnownMeasurement)\n    const input = {\n        before: Date.now(),\n        after: lastMeasurement.at\n    }\n    const metricName = name\n\n    const [result] = useQuery({\n        query: LAST_KNOWN_MEASUREMENT_QUERY,\n        variables: {\n            metricName,\n        },\n        pause: !metricName,\n        pollInterval: 5000,\n        requestPolicy: 'cache-and-network',\n    })\n\n    const [historicalResult] = useQuery({\n        query: MEASUREMENTS_QUERY,\n        variables: {\n            input,\n        },\n        pause: !metricName,\n        pollInterval: 5000,\n        requestPolicy: 'cache-and-network',\n    })\n\n    const { fetching, data, error} = result\n    useEffect(() => {\n        if(error){\n            console.log(error)\n        }\n        if (!data) return\n        const { getLastKnownMeasurement } = data\n        console.log(typeof getLastKnownMeasurement, getLastKnownMeasurement )\n        dispatch(actions.lastMeasurement(getLastKnownMeasurement))\n    }, [dispatch, data, error])\n\n    // console.log(historicalResult)\n\n    return(\n        <div>\n            <Graph />\n        </div>\n    )\n}\n\n\nexport default () => {\n    return(\n        <Provider value={client}>\n            <ShowData />\n        </Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}